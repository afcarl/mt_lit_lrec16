<PAPER>
  <FILENO/>
  <TITLE></TITLE>
  <AUTHORS/>
  <ABSTRACT/>
  <BODY>
    <DIV DEPTH="0">
      <HEADER>1 Introduction</HEADER>
      <P>
        <S ID="S-30036">A phrase-based SMT system takes a source sentence and produces a translation by segmenting the sentence into phrases and translating those phrases separately (Koehn et al., 2003).</S>
        <S ID="S-30037">The phrase translation table, which contains the bilingual phrase pairs and the corresponding translation probabilities, is one of the main components of an SMT system.</S>
        <S ID="S-30038">The most common method for obtaining the phrase table is heuristic extraction from automatically word-aligned bilingual training data (Och et al., 1999).</S>
        <S ID="S-30039">In this method, all phrases of the sentence pair that match constraints given by the alignment are extracted.</S>
        <S ID="S-30040">This includes overlapping phrases.</S>
        <S ID="S-30041">At extraction time it does not matter, whether the phrases are extracted from a highly probable phrase alignment or from an unlikely one.</S>
      </P>
      <P>
        <S ID="S-30042">Phrase model probabilities are typically defined as relative frequencies of phrases extracted from word-aligned parallel training data.</S>
        <S ID="S-30043">The joint counts C( &#732;f, &#7869;) of the source phrase &#732;f and the target phrase &#7869; in the entire training data are normalized by the marginal counts of source and target phrase to obtain a conditional probability</S>
      </P>
      <P>
        <S ID="S-30044">p H ( &#732;f|&#7869;) = C( &#732;f, &#7869;) C(&#7869;) .</S>
        <S ID="S-30045">(1)</S>
      </P>
      <P>
        <S ID="S-30046">The translation process is implemented as a weighted log-linear combination of several models h m (e I 1 , sK 1 , f 1 J ) including the logarithm of the phrase probability in source-to-target as well as in target-to-source direction.</S>
        <S ID="S-30047">The phrase model is combined with a language model, word lexicon models, word and phrase penalty, and many others.</S>
        <S ID="S-30048">(Och and Ney, 2004) The best translation &#234;&#206;1 as defined by the models then can be written as { M } &#8721;</S>
      </P>
      <P>
        <S ID="S-30049">&#234;&#206;1 = argmax &#955; m h m (e I 1, s K 1 , f1 J ) (2) I,e I 1 m=1</S>
      </P>
      <P>
        <S ID="S-30050">In this work, we propose to directly train our phrase models by applying a forced alignment procedure where we use the decoder to find a phrase alignment between source and target sentences of the training data and then updating phrase translation probabilities based on this alignment.</S>
        <S ID="S-30051">In contrast to heuristic extraction, the proposed method provides a way of consistently training and using phrase models in translation.</S>
        <S ID="S-30052">We use a modified version of a phrase-based decoder to perform the forced alignment.</S>
        <S ID="S-30053">This way we ensure that all models used in training are identical to the ones used at decoding time.</S>
        <S ID="S-30054">An illustration of the basic</S>
      </P>
      <P>
        <S ID="S-30055">idea can be seen in Figure 1.</S>
        <S ID="S-30056">In the literature this method by itself has been shown to be problematic because it suffers from over-fitting (DeNero et al., 2006), (Liang et al., 2006).</S>
        <S ID="S-30057">Since our initial phrases are extracted from the same training data, that we want to align, very long phrases can be found for segmentation.</S>
        <S ID="S-30058">As these long phrases tend to occur in only a few training sentences, the EM algorithm generally overestimates their probability and neglects shorter phrases, which better generalize to unseen data and thus are more useful for translation.</S>
        <S ID="S-30059">In order to counteract these effects, our training procedure applies leaving-one-out on the sentence level.</S>
        <S ID="S-30060">Our results show, that this leads to a better translation quality.</S>
      </P>
      <P>
        <S ID="S-30061">Ideally, we would produce all possible segmentations and alignments during training.</S>
        <S ID="S-30062">However, this has been shown to be infeasible for real-world data (DeNero and Klein, 2008).</S>
        <S ID="S-30063">As training uses a modified version of the translation decoder, it is straightforward to apply pruning as in regular decoding.</S>
        <S ID="S-30064">Additionally, we consider three ways of approximating the full search space:</S>
      </P>
      <P>
        <S ID="S-30065">1. the single-best Viterbi alignment,</S>
      </P>
      <P>
        <S ID="S-30066">2. the n-best alignments,</S>
      </P>
      <P>
        <S ID="S-30067">3. all alignments remaining in the search space after pruning.</S>
      </P>
      <P>
        <S ID="S-30068">The performance of the different approaches is measured and compared on the German-English Europarl task from the ACL 2008 Workshop on Statistical Machine Translation (WMT08).</S>
        <S ID="S-30069">Our results show that the proposed phrase model training improves translation quality on the test set by 0.9 BLEU points over our baseline.</S>
        <S ID="S-30070">We find that by interpolation with the heuristically extracted phrases translation performance can reach up to 1.4 BLEU improvement over the baseline on the test set.</S>
      </P>
      <P>
        <S ID="S-30071">After reviewing the related work in the following section, we give a detailed description of phrasal alignment and leaving-one-out in Section 3.</S>
        <S ID="S-30072">Section 4 explains the estimation of phrase models.</S>
        <S ID="S-30073">The empirical evaluation of the different approaches is done in Section 5.</S>
      </P>
    </DIV>
    <DIV DEPTH="0">
      <HEADER>2 Related Work</HEADER>
      <P>
        <S ID="S-30074">It has been pointed out in literature, that training phrase models poses some difficulties.</S>
        <S ID="S-30075">For a generative model, (DeNero et al., 2006) gave a detailed analysis of the challenges and arising problems.</S>
        <S ID="S-30076">They introduce a model similar to the one we propose in Section 4.2 and train it with the EM algorithm.</S>
        <S ID="S-30077">Their results show that it can not reach a performance competitive to extracting a phrase table from word alignment by heuristics (Och et al., 1999).</S>
      </P>
      <P>
        <S ID="S-30078">Several reasons are revealed in (DeNero et al., 2006).</S>
        <S ID="S-30079">When given a bilingual sentence pair, we can usually assume there are a number of equally correct phrase segmentations and corresponding alignments.</S>
        <S ID="S-30080">For example, it may be possible to transform one valid segmentation into another by splitting some of its phrases into sub-phrases or by shifting phrase boundaries.</S>
        <S ID="S-30081">This is different from word-based translation models, where a typical assumption is that each target word corresponds to only one source word.</S>
        <S ID="S-30082">As a result of this ambiguity, different segmentations are recruited for different examples during training.</S>
        <S ID="S-30083">That in turn leads to over-fitting which shows in overly determinized estimates of the phrase translation probabilities.</S>
        <S ID="S-30084">In addition, (DeNero et al., 2006) found that the trained phrase table shows a highly peaked distribution in opposition to the more flat distribution resulting from heuristic extraction, leaving the decoder only few translation options at decoding time.</S>
      </P>
      <P>
        <S ID="S-30085">Our work differs from (DeNero et al., 2006) in a number of ways, addressing those problems.</S>
      </P>
      <P>
        <S ID="S-30086">To limit the effects of over-fitting, we apply the leaving-one-out and cross-validation methods in training.</S>
        <S ID="S-30087">In addition, we do not restrict the training to phrases consistent with the word alignment, as was done in (DeNero et al., 2006).</S>
        <S ID="S-30088">This allows us to recover from flawed word alignments.</S>
      </P>
      <P>
        <S ID="S-30089">In (Liang et al., 2006) a discriminative translation system is described.</S>
        <S ID="S-30090">For training of the parameters for the discriminative features they propose a strategy they call bold updating.</S>
        <S ID="S-30091">It is similar to our forced alignment training procedure described in Section 3.</S>
      </P>
      <P>
        <S ID="S-30092">For the hierarchical phrase-based approach, (Blunsom et al., 2008) present a discriminative rule model and show the difference between using only the viterbi alignment in training and using the full sum over all possible derivations.</S>
      </P>
      <P>
        <S ID="S-30093">Forced alignment can also be utilized to train a phrase segmentation model, as is shown in (Shen et al., 2008).</S>
        <S ID="S-30094">They report small but consistent improvements by incorporating this segmentation model, which works as an additional prior probability on the monolingual target phrase.</S>
      </P>
      <P>
        <S ID="S-30095">In (Ferrer and Juan, 2009), phrase models are trained by a semi-hidden Markov model.</S>
        <S ID="S-30096">They train a conditional &#8220;inverse&#8221; phrase model of the target phrase given the source phrase.</S>
        <S ID="S-30097">Additionally to the phrases, they model the segmentation sequence that is used to produce a phrase alignment between the source and the target sentence.</S>
        <S ID="S-30098">They used a phrase length limit of 4 words with longer phrases not resulting in further improvements.</S>
        <S ID="S-30099">To counteract over-fitting, they interpolate the phrase model with IBM Model 1 probabilities that are computed on the phrase level.</S>
        <S ID="S-30100">We also include these word lexica, as they are standard components of the phrase-based system.</S>
      </P>
      <P>
        <S ID="S-30101">It is shown in (Ferrer and Juan, 2009), that Viterbi training produces almost the same results as full Baum-Welch training.</S>
        <S ID="S-30102">They report improvements over a phrase-based model that uses an inverse phrase model and a language model.</S>
        <S ID="S-30103">Experiments are carried out on a custom subset of the English-Spanish Europarl corpus.</S>
      </P>
      <P>
        <S ID="S-30104">Our approach is similar to the one presented in (Ferrer and Juan, 2009) in that we compare Viterbi and a training method based on the Forward- Backward algorithm.</S>
        <S ID="S-30105">But instead of focusing on the statistical model and relaxing the translation task by using monotone translation only, we use a full and competitive translation system as starting point with reordering and all models included.</S>
      </P>
      <P>
        <S ID="S-30106">In (Marcu and Wong, 2002), a joint probability phrase model is presented.</S>
        <S ID="S-30107">The learned phrases are restricted to the most frequent n-grams up to length 6 and all unigrams.</S>
        <S ID="S-30108">Monolingual phrases have to occur at least 5 times to be considered in training.</S>
        <S ID="S-30109">Smoothing is applied to the learned models so that probabilities for rare phrases are non-zero.</S>
        <S ID="S-30110">In training, they use a greedy algorithm to produce the Viterbi phrase alignment and then apply a hill-climbing technique that modifies the Viterbi alignment by merge, move, split, and swap operations to find an alignment with a better probability in each iteration.</S>
        <S ID="S-30111">The model shows improvements in translation quality over the singleword-based IBM Model 4 (Brown et al., 1993) on a subset of the Canadian Hansards corpus.</S>
      </P>
      <P>
        <S ID="S-30112">The joint model by (Marcu and Wong, 2002) is refined by (Birch et al., 2006) who use high-confidence word alignments to constrain the search space in training.</S>
        <S ID="S-30113">They observe that due to several constraints and pruning steps, the trained phrase table is much smaller than the heuristically extracted one, while preserving translation quality.</S>
      </P>
      <P>
        <S ID="S-30114">The work by (DeNero et al., 2008) describes a method to train the joint model described in (Marcu and Wong, 2002) with a Gibbs sampler.</S>
        <S ID="S-30115">They show that by applying a prior distribution over the phrase translation probabilities they can prevent over-fitting.</S>
        <S ID="S-30116">The prior is composed of IBM1 lexical probabilities and a geometric distribution over phrase lengths which penalizes long phrases.</S>
        <S ID="S-30117">The two approaches differ in that we apply the leaving-one-out procedure to avoid overfitting, as opposed to explicitly defining a prior distribution.</S>
      </P>
    </DIV>
    <DIV DEPTH="0">
      <HEADER>3 Alignment</HEADER>
      <P>
        <S ID="S-30188">The training process is divided into three parts.</S>
        <S ID="S-30189">First we obtain all models needed for a normal translations system.</S>
        <S ID="S-30190">We perform minimum error rate training with the downhill simplex algorithm (Nelder and Mead, 1965) on the development data to obtain a set of scaling factors that achieve a good BLEU score.</S>
        <S ID="S-30191">We then use these models and scaling factors to do a forced alignment, where we compute a phrase alignment for the training data.</S>
        <S ID="S-30192">From this alignment we then estimate new phrase models, while keeping all other models un-</S>
      </P>
      <P>
        <S ID="S-30193">changed.</S>
        <S ID="S-30194">In this section we describe our forced alignment procedure that is the basic training procedure for the models proposed here.</S>
      </P>
      <DIV DEPTH="1">
        <HEADER>3.1 Forced Alignment</HEADER>
        <P>
          <S ID="S-30118">The idea of forced alignment is to perform a phrase segmentation and alignment of each sentence pair of the training data using the full translation system as in decoding.</S>
          <S ID="S-30119">What we call segmentation and alignment here corresponds to the &#8220;concepts&#8221; used by (Marcu and Wong, 2002).</S>
          <S ID="S-30120">We apply our normal phrase-based decoder on the source side of the training data and constrain the translations to the corresponding target sentences from the training data.</S>
        </P>
        <P>
          <S ID="S-30121">Given a source sentence f1 J and target sentence e I 1 , we search for the best phrase segmentation and alignment that covers both sentences.</S>
          <S ID="S-30122">A segmentation of a sentence into K phrase is defined by</S>
        </P>
        <P>
          <S ID="S-30123">k &#8594; s k := (i k , b k , j k ), for k = 1, .</S>
          <S ID="S-30124">.</S>
          <S ID="S-30125">.</S>
          <S ID="S-30126">, K</S>
        </P>
        <P>
          <S ID="S-30127">where for each segment i k is last position of kth target phrase, and (b k , j k ) are the start and end positions of the source phrase aligned to the kth target phrase.</S>
          <S ID="S-30128">Consequently, we can modify Equation 2 to define the best segmentation of a sentence pair as: { M }</S>
        </P>
        <P>
          <S ID="S-30129">&#349; &#710;K &#8721;</S>
        </P>
        <P>
          <S ID="S-30130">1 = argmax &#955; m h m (e I 1, s K 1 , f1 J ) (3) K,s K 1 m=1</S>
        </P>
        <P>
          <S ID="S-30131">The identical models as in search are used: conditional phrase probabilities p( &#732;f k |&#7869; k ) and p(&#7869; k | &#732;f k ), within-phrase lexical probabilities, distance-based reordering model as well as word and phrase penalty.</S>
          <S ID="S-30132">A language model is not used in this case, as the system is constrained to the given target sentence and thus the language model score has no effect on the alignment.</S>
        </P>
        <P>
          <S ID="S-30133">In addition to the phrase matching on the source sentence, we also discard all phrase translation candidates, that do not match any sequence in the given target sentence.</S>
        </P>
        <P>
          <S ID="S-30134">Sentences for which the decoder can not find an alignment are discarded for the phrase model training.</S>
          <S ID="S-30135">In our experiments, this is the case for roughly 5% of the training sentences.</S>
        </P>
      </DIV>
      <DIV DEPTH="1">
        <HEADER>3.2 Leaving-one-out</HEADER>
        <P>
          <S ID="S-30136">As was mentioned in Section 2, previous approaches found over-fitting to be a problem in phrase model training.</S>
          <S ID="S-30137">In this section, we describe a leaving-one-out method that can improve the phrase alignment in situations, where the probability of rare phrases and alignments might be overestimated.</S>
          <S ID="S-30138">The training data that consists of N parallel sentence pairs f n and e n for n = 1, .</S>
          <S ID="S-30139">.</S>
          <S ID="S-30140">.</S>
          <S ID="S-30141">, N is used for both the initialization of the translation model p( &#732;f|&#7869;) and the phrase model training.</S>
          <S ID="S-30142">While this way we can make full use of the available data and avoid unknown words during training, it has the drawback that it can lead to overfitting.</S>
          <S ID="S-30143">All phrases extracted from a specific sentence pair f n , e n can be used for the alignment of this sentence pair.</S>
          <S ID="S-30144">This includes longer phrases, which only match in very few sentences in the data.</S>
          <S ID="S-30145">Therefore those long phrases are trained to fit only a few sentence pairs, strongly overestimating their translation probabilities and failing to generalize.</S>
          <S ID="S-30146">In the extreme case, whole sentences will be learned as phrasal translations.</S>
          <S ID="S-30147">The average length of the used phrases is an indicator of this kind of over-fitting, as the number of matching training sentences decreases with increasing phrase length.</S>
          <S ID="S-30148">We can see an example in Figure 2.</S>
          <S ID="S-30149">Without leaving-one-out the sentence is segmented into a few long phrases, which are unlikely to occur in data to be translated.</S>
          <S ID="S-30150">Phrase boundaries seem to be unintuitive and based on some hidden structures.</S>
          <S ID="S-30151">With leaving-one-out the phrases are shorter and therefore better suited for generalization to unseen data.</S>
        </P>
        <P>
          <S ID="S-30152">Previous attempts have dealt with the overfitting problem by limiting the maximum phrase length (DeNero et al., 2006; Marcu and Wong, 2002) and by smoothing the phrase probabilities by lexical models on the phrase level (Ferrer and Juan, 2009).</S>
          <S ID="S-30153">However, (DeNero et al., 2006) experienced similar over-fitting with short phrases due to the fact that the same word sequence can be segmented in different ways, leading to specific segmentations being learned for specific training sentence pairs.</S>
          <S ID="S-30154">Our results confirm these findings.</S>
          <S ID="S-30155">To deal with this problem, instead of simple phrase length restriction, we propose to apply the leavingone-out method, which is also used for language modeling techniques (Kneser and Ney, 1995).</S>
        </P>
        <P>
          <S ID="S-30156">When using leaving-one-out, we modify the phrase translation probabilities for each sentence pair.</S>
          <S ID="S-30157">For a training example f n , e n , we have to remove all phrases C n ( &#732;f, &#7869;) that were extracted from this sentence pair from the phrase counts that</S>
        </P>
        <P>
          <S ID="S-30158">we used to construct our phrase translation table.</S>
          <S ID="S-30159">The same holds for the marginal counts C n (&#7869;) and C n ( &#732;f).</S>
          <S ID="S-30160">Starting from Equation 1, the leaving-oneout phrase probability for training sentence pair n is</S>
        </P>
        <P>
          <S ID="S-30161">p l1o,n ( &#732;f|&#7869;) = C( &#732;f, &#7869;) &#8722; C n ( &#732;f, &#7869;) (4) C(&#7869;) &#8722; C n (&#7869;)</S>
        </P>
        <P>
          <S ID="S-30162">To be able to perform the re-computation in an efficient way, we store the source and target phrase marginal counts for each phrase in the phrase table.</S>
          <S ID="S-30163">A phrase extraction is performed for each training sentence pair separately using the same word alignment as for the initialization.</S>
          <S ID="S-30164">It is then straightforward to compute the phrase counts after leaving-one-out using the phrase probabilities and marginal counts stored in the phrase table.</S>
        </P>
        <P>
          <S ID="S-30165">While this works well for more frequent observations, singleton phrases are assigned a probability of zero.</S>
          <S ID="S-30166">We refer to singleton phrases as phrase pairs that occur only in one sentence.</S>
          <S ID="S-30167">For these sentences, the decoder needs the singleton phrase pairs to produce an alignment.</S>
          <S ID="S-30168">Therefore we retain those phrases by assigning them a positive probability close to zero.</S>
          <S ID="S-30169">We evaluated with two different strategies for this, which we call standard and length-based leaving-one-out.</S>
          <S ID="S-30170">Standard leavingone-out assigns a fixed probability &#945; to singleton phrase pairs.</S>
          <S ID="S-30171">This way the decoder will prefer using more frequent phrases for the alignment, but is able to resort to singletons if necessary.</S>
          <S ID="S-30172">However, we found that with this method longer singleton phrases are preferred over shorter ones, because fewer of them are needed to produce the target sentence.</S>
          <S ID="S-30173">In order to better generalize to unseen data, we would like to give the preference to shorter phrases.</S>
          <S ID="S-30174">This is done by length-based leavingone-out, where singleton phrases are assigned the probability &#946; (| &#732;f|+|&#7869;|) with the source and target Table 1: Avg.</S>
          <S ID="S-30175">source phrase lengths in forced alignment without leaving-one-out and with standard and length-based leaving-one-out.</S>
        </P>
        <P>
          <S ID="S-30176">phrase lengths | &#732;f| and |&#7869;| and fixed &#946; &lt; 1.</S>
          <S ID="S-30177">In our experiments we set &#945; = e &#8722;20 and &#946; = e &#8722;5 .</S>
          <S ID="S-30178">Table 1 shows the decrease in average source phrase length by application of leaving-one-out.</S>
        </P>
      </DIV>
      <DIV DEPTH="1">
        <HEADER>3.3 Cross-validation</HEADER>
        <P>
          <S ID="S-30179">For the first iteration of the phrase training, leaving-one-out can be implemented efficiently as described in Section 3.2.</S>
          <S ID="S-30180">For higher iterations, phrase counts obtained in the previous iterations would have to be stored on disk separately for each sentence and accessed during the forced alignment process.</S>
          <S ID="S-30181">To simplify this procedure, we propose a cross-validation strategy on larger batches of data.</S>
          <S ID="S-30182">Instead of recomputing the phrase counts for each sentence individually, this is done for a whole batch of sentences at a time.</S>
          <S ID="S-30183">In our experiments, we set this batch-size to 10000 sentences.</S>
        </P>
      </DIV>
      <DIV DEPTH="1">
        <HEADER>3.4 Parallelization</HEADER>
        <P>
          <S ID="S-30184">To cope with the runtime and memory requirements of phrase model training that was pointed out by previous work (Marcu and Wong, 2002; Birch et al., 2006), we parallelized the forced alignment by splitting the training corpus into blocks of 10k sentence pairs.</S>
          <S ID="S-30185">From the initial phrase table, each of these blocks only loads the phrases that are required for alignment.</S>
          <S ID="S-30186">The align-</S>
        </P>
        <P>
          <S ID="S-30187">ment and the counting of phrases are done separately for each block and then accumulated to build the updated phrase model.</S>
        </P>
      </DIV>
    </DIV>
    <DIV DEPTH="0">
      <HEADER>4 Phrase Model Training</HEADER>
      <P>
        <S ID="S-30233">The produced phrase alignment can be given as a single best alignment, as the n-best alignments or as an alignment graph representing all alignments considered by the decoder.</S>
        <S ID="S-30234">We have developed two different models for phrase translation probabilities which make use of the force-aligned training data.</S>
        <S ID="S-30235">Additionally we consider smoothing by different kinds of interpolation of the generative model with the state-of-the-art heuristics.</S>
      </P>
      <DIV DEPTH="1">
        <HEADER>4.1 Viterbi</HEADER>
        <P>
          <S ID="S-30195">The simplest of our generative phrase models estimates phrase translation probabilities by their relative frequencies in the Viterbi alignment of the data, similar to the heuristic model but with counts from the phrase-aligned data produced in training rather than computed on the basis of a word alignment.</S>
          <S ID="S-30196">The translation probability of a phrase pair ( &#732;f, &#7869;) is estimated as</S>
        </P>
        <P>
          <S ID="S-30197">p F A ( &#732;f|&#7869;) = C F A( &#732;f, &#7869;) &#8721;</S>
        </P>
        <P>
          <S ID="S-30198">C F A ( &#732;f &#8242; , &#7869;)</S>
        </P>
        <P>
          <S ID="S-30199">&#732;f &#8242;</S>
        </P>
        <P>
          <S ID="S-30200">(5)</S>
        </P>
        <P>
          <S ID="S-30201">where C F A ( &#732;f, &#7869;) is the count of the phrase pair ( &#732;f, &#7869;) in the phrase-aligned training data.</S>
          <S ID="S-30202">This can be applied to either the Viterbi phrase alignment or an n-best list.</S>
          <S ID="S-30203">For the simplest model, each hypothesis in the n-best list is weighted equally.</S>
          <S ID="S-30204">We will refer to this model as the count model as we simply count the number of occurrences of a phrase pair.</S>
          <S ID="S-30205">We also experimented with weighting the counts with the estimated likelihood of the corresponding entry in the the n-best list.</S>
          <S ID="S-30206">The sum of the likelihoods of all entries in an n-best list is normalized to 1.</S>
          <S ID="S-30207">We will refer to this model as the weighted count model.</S>
        </P>
      </DIV>
      <DIV DEPTH="1">
        <HEADER>4.2 Forward-backward</HEADER>
        <P>
          <S ID="S-30208">Ideally, the training procedure would consider all possible alignment and segmentation hypotheses.</S>
          <S ID="S-30209">When alternatives are weighted by their posterior probability.</S>
          <S ID="S-30210">As discussed earlier, the run-time requirements for computing all possible alignments is prohibitive for large data tasks.</S>
          <S ID="S-30211">However, we can approximate the space of all possible hypotheses by the search space that was used for the alignment.</S>
          <S ID="S-30212">While this might not cover all phrase translation probabilities, it allows the search space and translation times to be feasible and still contains the most probable alignments.</S>
          <S ID="S-30213">This search space can be represented as a graph of partial hypotheses (Ueffing et al., 2002) on which we can compute expectations using the Forward-Backward algorithm.</S>
          <S ID="S-30214">We will refer to this alignment as the full alignment.</S>
          <S ID="S-30215">In contrast to the method described in Section 4.1, phrases are weighted by their posterior probability in the word graph.</S>
          <S ID="S-30216">As suggested in work on minimum Bayes-risk decoding for SMT (Tromble et al., 2008; Ehling et al., 2007), we use a global factor to scale the posterior probabilities.</S>
        </P>
      </DIV>
      <DIV DEPTH="1">
        <HEADER>4.3 Phrase Table Interpolation</HEADER>
        <P>
          <S ID="S-30217">As (DeNero et al., 2006) have reported improvements in translation quality by interpolation of phrase tables produced by the generative and the heuristic model, we adopt this method and also report results using log-linear interpolation of the estimated model with the original model.</S>
        </P>
        <P>
          <S ID="S-30218">The log-linear interpolations p int ( &#732;f|&#7869;) of the phrase translation probabilities are estimated as</S>
        </P>
        <P>
          <S ID="S-30219">p int ( &#732;f|&#7869;) = ( &#732;f|&#7869;)) 1&#8722;&#969; ( p H ( &#183; p gen ( &#732;f|&#7869;) ) (&#969;)</S>
        </P>
        <P>
          <S ID="S-30220">(6)</S>
        </P>
        <P>
          <S ID="S-30221">where &#969; is the interpolation weight, p H the heuristically estimated phrase model and p gen the count model.</S>
          <S ID="S-30222">The interpolation weight &#969; is adjusted on the development corpus.</S>
          <S ID="S-30223">When interpolating phrase tables containing different sets of phrase pairs, we retain the intersection of the two.</S>
        </P>
        <P>
          <S ID="S-30224">As a generalization of the fixed interpolation of the two phrase tables we also experimented with adding the two trained phrase probabilities as additional features to the log-linear framework.</S>
          <S ID="S-30225">This way we allow different interpolation weights for the two translation directions and can optimize them automatically along with the other feature weights.</S>
          <S ID="S-30226">We will refer to this method as featurewise combination.</S>
          <S ID="S-30227">Again, we retain the intersection of the two phrase tables.</S>
          <S ID="S-30228">With good loglinear feature weights, feature-wise combination should perform at least as well as fixed interpolation.</S>
          <S ID="S-30229">However, the results presented in Table 5</S>
        </P>
        <P>
          <S ID="S-30230">German English</S>
        </P>
        <P>
          <S ID="S-30231">show a slightly lower performance.</S>
          <S ID="S-30232">This illustrates that a higher number of features results in a less reliable optimization of the log-linear parameters.</S>
        </P>
      </DIV>
    </DIV>
    <DIV DEPTH="0">
      <HEADER>5 Experimental Evaluation</HEADER>
      <P>
        <S ID="S-30301"></S>
      </P>
      <DIV DEPTH="1">
        <HEADER>5.1 Experimental Setup</HEADER>
        <P>
          <S ID="S-30236">We conducted our experiments on the German- English data published for the ACL 2008 Workshop on Statistical Machine Translation (WMT08).</S>
          <S ID="S-30237">Statistics for the Europarl data are given in Table 2.</S>
        </P>
        <P>
          <S ID="S-30238">We are given the three data sets T RAIN, DEV and T EST .</S>
          <S ID="S-30239">For the heuristic phrase model, we first use GIZA++ (Och and Ney, 2003) to compute the word alignment on T RAIN.</S>
          <S ID="S-30240">Next we obtain a phrase table by extraction of phrases from the word alignment.</S>
          <S ID="S-30241">The scaling factors of the translation models have been optimized for BLEU on the DEV data.</S>
        </P>
        <P>
          <S ID="S-30242">The phrase table obtained by heuristic extraction is also used to initialize the training.</S>
          <S ID="S-30243">The forced alignment is run on the training data T RAIN from which we obtain the phrase alignments.</S>
          <S ID="S-30244">Those are used to build a phrase table according to the proposed generative phrase models.</S>
          <S ID="S-30245">Afterward, the scaling factors are trained on DEV for the new phrase table.</S>
          <S ID="S-30246">By feeding back the new phrase table into forced alignment we can reiterate the training procedure.</S>
          <S ID="S-30247">When training is finished the resulting phrase model is evaluated on DEV Table 3: Comparison of different training setups for the count model on DEV .</S>
        </P>
        <P>
          <S ID="S-30248">leaving-one-out max phr.len.</S>
          <S ID="S-30249">BLEU TER baseline 6 25.7 61.1</S>
        </P>
        <P>
          <S ID="S-30250">and T EST .</S>
          <S ID="S-30251">Additionally, we can apply smoothing by interpolation of the new phrase table with the original one estimated heuristically, retrain the scaling factors and evaluate afterwards.</S>
        </P>
        <P>
          <S ID="S-30252">The baseline system is a standard phrase-based SMT system with eight features: phrase translation and word lexicon probabilities in both translation directions, phrase penalty, word penalty, language model score and a simple distance-based reordering model.</S>
          <S ID="S-30253">The features are combined in a log-linear way.</S>
          <S ID="S-30254">To investigate the generative models, we replace the two phrase translation probabilities and keep the other features identical to the baseline.</S>
          <S ID="S-30255">For the feature-wise combination the two generative phrase probabilities are added to the features, resulting in a total of 10 features.</S>
          <S ID="S-30256">We used a 4-gram language model with modified Kneser-Ney discounting for all experiments.</S>
          <S ID="S-30257">The metrics used for evaluation are the case-sensitive</S>
        </P>
        <P>
          <S ID="S-30258">BLEU (Papineni et al., 2002) score and the translation edit rate (TER) (Snover et al., 2006) with one reference translation.</S>
        </P>
      </DIV>
      <DIV DEPTH="1">
        <HEADER>5.2 Results</HEADER>
        <P>
          <S ID="S-30259">In this section, we investigate the different aspects of the models and methods presented before.</S>
          <S ID="S-30260">We will focus on the proposed leaving-oneout technique and show that it helps in finding good phrasal alignments on the training data that lead to improved translation models.</S>
          <S ID="S-30261">Our final results show an improvement of 1.4 BLEU over the heuristically extracted phrase model on the test data set.</S>
        </P>
        <P>
          <S ID="S-30262">In Section 3.2 we have discussed several methods which aim to overcome the over-fitting prob-</S>
        </P>
        <P>
          <S ID="S-30263">lems described in (DeNero et al., 2006).</S>
          <S ID="S-30264">Table 3 shows translation scores of the count model on the development data after the first training iteration for both leaving-one-out strategies we have introduced and for training without leaving-one-out with different restrictions on phrase length.</S>
          <S ID="S-30265">We can see that by restricting the source phrase length to a maximum of 3 words, the trained model is close to the performance of the heuristic phrase model.</S>
          <S ID="S-30266">With the application of leaving-one-out, the trained model is superior to the baseline, the length-based strategy performing slightly better than standard leaving-one-out.</S>
          <S ID="S-30267">For these experiments the count model was estimated with a 100- best list.</S>
        </P>
        <P>
          <S ID="S-30268">The count model we describe in Section 4.1 estimates phrase translation probabilities using counts from the n-best phrase alignments.</S>
          <S ID="S-30269">For smaller n the resulting phrase table contains fewer phrases and is more deterministic.</S>
          <S ID="S-30270">For higher values of n more competing alignments are taken into account, resulting in a bigger phrase table and a smoother distribution.</S>
          <S ID="S-30271">We can see in Figure 3 that translation performance improves by moving from the Viterbi alignment to n-best alignments.</S>
          <S ID="S-30272">The variations in performance with sizes between n = 10 and n = 10000 are less than 0.2 BLEU.</S>
          <S ID="S-30273">The maximum is reached for n = 100, which we used in all subsequent experiments.</S>
          <S ID="S-30274">An additional benefit of the count model is the smaller phrase table size compared to the heuristic phrase extraction.</S>
          <S ID="S-30275">This is consistent with the findings of (Birch et al., 2006).</S>
          <S ID="S-30276">Table 4 shows the phrase table sizes for different n.</S>
          <S ID="S-30277">With n = 100 we retain only 17% of the original phrases.</S>
          <S ID="S-30278">Even for the full model, we Table 4: Phrase table size of the count model for different n-best list sizes, the full model and for heuristic phrase extraction.</S>
        </P>
        <P>
          <S ID="S-30279">do not retain all phrase table entries.</S>
          <S ID="S-30280">Due to pruning in the forced alignment step, not all translation options are considered.</S>
          <S ID="S-30281">As a result experiments can be done more rapidly and with less resources than with the heuristically extracted phrase table.</S>
          <S ID="S-30282">Also, our experiments show that the increased performance of the count model is partly derived from the smaller phrase table size.</S>
          <S ID="S-30283">In Table 5 we can see that the performance of the heuristic phrase model can be increased by 0.6 BLEU on T EST by filtering the phrase table to contain the same phrases as the count model and reoptimizing the log-linear model weights.</S>
          <S ID="S-30284">The experiments on the number of different alignments taken into account were done with standard leaving-one-out.</S>
        </P>
        <P>
          <S ID="S-30285">The final results are given in Table 5.</S>
          <S ID="S-30286">We can see that the count model outperforms the baseline by 0.8 BLEU on DEV and 0.9 BLEU on T EST after the first training iteration.</S>
          <S ID="S-30287">The performance of the filtered baseline phrase table shows that part of that improvement derives from the smaller phrase table size.</S>
          <S ID="S-30288">Application of crossvalidation (cv) in the first iteration yields a performance close to training with leaving-one-out (l1o), which indicates that cross-validation can be safely applied to higher training iterations as an alternative to leaving-one-out.</S>
          <S ID="S-30289">The weighted count model clearly under-performs the simpler count model.</S>
          <S ID="S-30290">A second iteration of the training algorithm shows nearly no changes in BLEU score, but a small improvement in TER.</S>
          <S ID="S-30291">Here, we used the phrase table trained with leaving-one-out in the first iteration and applied cross-validation in the second iteration.</S>
          <S ID="S-30292">Log-linear interpolation of the count model with the heuristic yields a further increase, showing an improvement of 1.3 BLEU on DEV and 1.4</S>
        </P>
        <P>
          <S ID="S-30293">BLEU on T EST over the baseline.</S>
          <S ID="S-30294">The interpo-</S>
        </P>
        <P>
          <S ID="S-30295">lation weight is adjusted on the development set and was set to &#969; = 0.6.</S>
          <S ID="S-30296">Integrating both models into the log-linear framework (feat.</S>
          <S ID="S-30297">comb.</S>
          <S ID="S-30298">) yields a BLEU score slightly lower than with fixed interpolation on both DEV and T EST .</S>
          <S ID="S-30299">This might be attributed to deficiencies in the tuning procedure.</S>
          <S ID="S-30300">The full model, where we extract all phrases from the search graph, weighted with their posterior probability, performs comparable to the count model with a slightly worse BLEU and a slightly better TER.</S>
        </P>
      </DIV>
    </DIV>
    <DIV DEPTH="0">
      <HEADER>6 Conclusion</HEADER>
      <P>
        <S ID="S-30302">We have shown that training phrase models can improve translation performance on a state-ofthe-art phrase-based translation model.</S>
        <S ID="S-30303">This is achieved by training phrase translation probabilities in a way that they are consistent with their use in translation.</S>
        <S ID="S-30304">A crucial aspect here is the use of leaving-one-out to avoid over-fitting.</S>
        <S ID="S-30305">We have shown that the technique is superior to limiting phrase lengths and smoothing with lexical probabilities alone.</S>
      </P>
      <P>
        <S ID="S-30306">While models trained from Viterbi alignments already lead to good results, we have demonstrated that considering the 100-best alignments allows to better model the ambiguities in phrase segmentation.</S>
      </P>
      <P>
        <S ID="S-30307">The proposed techniques are shown to be superior to previous approaches that only used lexical probabilities to smooth phrase tables or imposed limits on the phrase lengths.</S>
        <S ID="S-30308">On the WMT08 Europarl task we show improvements of 0.9 BLEU points with the trained phrase table and 1.4 BLEU points when interpolating the newly trained model with the original, heuristically extracted phrase table.</S>
        <S ID="S-30309">In TER, improvements are 0.4 and 1.7 points.</S>
      </P>
      <P>
        <S ID="S-30310">In addition to the improved performance, the trained models are smaller leading to faster and smaller translation systems.</S>
      </P>
      <P>
        <S ID="S-30311">Acknowledgments</S>
      </P>
      <P>
        <S ID="S-30312">This work was partly realized as part of the Quaero Programme, funded by OSEO, French State agency for innovation, and also partly based upon work supported by the Defense Advanced Research Projects Agency (DARPA) under Contract No.</S>
        <S ID="S-30313">HR001-06-C-0023.</S>
        <S ID="S-30314">Any opinions, ndings and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reect the views of the DARPA.</S>
      </P>
      <P>
        <S ID="S-30315">References</S>
      </P>
      <P>
        <S ID="S-30316">Alexandra Birch, Chris Callison-Burch, Miles Osborne, and Philipp Koehn.</S>
        <S ID="S-30317">2006.</S>
        <S ID="S-30318">Constraining the phrase-based, joint probability statistical translation model.</S>
        <S ID="S-30319">In smt2006, pages 154&#8211;157, Jun.</S>
      </P>
      <P>
        <S ID="S-30320">Phil Blunsom, Trevor Cohn, and Miles Osborne.</S>
        <S ID="S-30321">2008.</S>
        <S ID="S-30322">A discriminative latent variable model for statistical machine translation.</S>
        <S ID="S-30323">In Proceedings of ACL-08: HLT, pages 200&#8211;208, Columbus, Ohio, June.</S>
        <S ID="S-30324">Association for Computational Linguistics.</S>
      </P>
      <P>
        <S ID="S-30325">P. F. Brown, V.</S>
        <S ID="S-30326">J. Della Pietra, S.</S>
        <S ID="S-30327">A. Della Pietra, and R.</S>
        <S ID="S-30328">L. Mercer.</S>
        <S ID="S-30329">1993.</S>
        <S ID="S-30330">The mathematics of statistical machine translation: parameter estimation.</S>
        <S ID="S-30331">Computational Linguistics, 19(2):263&#8211;312, June.</S>
      </P>
      <P>
        <S ID="S-30332">John DeNero and Dan Klein.</S>
        <S ID="S-30333">2008.</S>
        <S ID="S-30334">The complexity of phrase alignment problems.</S>
        <S ID="S-30335">In Proceedings of the 46th Annual Meeting of the Association for Computational Linguistics on Human Language Technologies: Short Papers, pages 25&#8211;28, Morristown, NJ, USA.</S>
        <S ID="S-30336">Association for Computational Linguistics.</S>
      </P>
      <P>
        <S ID="S-30337">John DeNero, Dan Gillick, James Zhang, and Dan Klein.</S>
        <S ID="S-30338">2006.</S>
        <S ID="S-30339">Why Generative Phrase Models Underperform Surface Heuristics.</S>
        <S ID="S-30340">In Proceedings of the</S>
      </P>
      <P>
        <S ID="S-30341">Workshop on Statistical Machine Translation, pages 31&#8211;38, New York City, June.</S>
      </P>
      <P>
        <S ID="S-30342">John DeNero, Alexandre Buchard-C&#244;t&#233;, and Dan Klein.</S>
        <S ID="S-30343">2008.</S>
        <S ID="S-30344">Sampling Alignment Structure under a Bayesian Translation Model.</S>
        <S ID="S-30345">In Proceedings of the 2008 Conference on Empirical Methods in Natural Language Processing, pages 314&#8211;323, Honolulu, October.</S>
      </P>
      <P>
        <S ID="S-30346">Nicola Ehling, Richard Zens, and Hermann Ney.</S>
        <S ID="S-30347">2007.</S>
        <S ID="S-30348">Minimum bayes risk decoding for bleu.</S>
        <S ID="S-30349">In ACL &#8217;07: Proceedings of the 45th Annual Meeting of the ACL on Interactive Poster and Demonstration Sessions, pages 101&#8211;104, Morristown, NJ, USA.</S>
        <S ID="S-30350">Association for Computational Linguistics.</S>
      </P>
      <P>
        <S ID="S-30351">Jes&#250;s-Andr&#233;s Ferrer and Alfons Juan.</S>
        <S ID="S-30352">2009.</S>
        <S ID="S-30353">A phrasebased hidden semi-markov approach to machine translation.</S>
        <S ID="S-30354">In Procedings of European Association for Machine Translation (EAMT), Barcelona, Spain, May.</S>
        <S ID="S-30355">European Association for Machine Translation.</S>
      </P>
      <P>
        <S ID="S-30356">Reinhard Kneser and Hermann Ney.</S>
        <S ID="S-30357">1995.</S>
        <S ID="S-30358">Improved Backing-Off for M-gram Language Modelling.</S>
        <S ID="S-30359">In IEEE Int.</S>
        <S ID="S-30360">Conf. on Acoustics, Speech and Signal Processing (ICASSP), pages 181&#8211;184, Detroit, MI, May.</S>
      </P>
      <P>
        <S ID="S-30361">Philipp Koehn, Franz Josef Och, and Daniel Marcu.</S>
        <S ID="S-30362">2003.</S>
        <S ID="S-30363">Statistical phrase-based translation.</S>
        <S ID="S-30364">In Proceedings of the 2003 Conference of the North American Chapter of the Association for Computational Linguistics on Human Language Technology - Volume 1, pages 48&#8211;54, Morristown, NJ, USA.</S>
        <S ID="S-30365">Association for Computational Linguistics.</S>
      </P>
      <P>
        <S ID="S-30366">F.J.</S>
        <S ID="S-30367">Och, C. Tillmann, and H. Ney.</S>
        <S ID="S-30368">1999.</S>
        <S ID="S-30369">Improved alignment models for statistical machine translation.</S>
        <S ID="S-30370">In Proc. of the Joint SIGDAT Conf. on Empirical Methods in Natural Language Processing and Very Large Corpora (EMNLP99), pages 20&#8211;28, University of Maryland, College Park, MD, USA, June.</S>
      </P>
      <P>
        <S ID="S-30371">Kishore Papineni, Salim Roukos, Todd Ward, and Wei- Jing Zhu.</S>
        <S ID="S-30372">2002.</S>
        <S ID="S-30373">Bleu: a method for automatic evaluation of machine translation.</S>
        <S ID="S-30374">In Proceedings of the 40th Annual Meeting on Association for Computational Linguistics, pages 311&#8211;318, Morristown, NJ, USA.</S>
        <S ID="S-30375">Association for Computational Linguistics.</S>
      </P>
      <P>
        <S ID="S-30376">Wade Shen, Brian Delaney, Tim Anderson, and Ray Slyh.</S>
        <S ID="S-30377">2008.</S>
        <S ID="S-30378">The MIT-LL/AFRL IWSLT-2008 MT System.</S>
        <S ID="S-30379">In Proceedings of IWSLT 2008, pages 69&#8211; 76, Hawaii, U.S.A., October.</S>
      </P>
      <P>
        <S ID="S-30380">Matthew Snover, Bonnie Dorr, Rich Schwartz, Linnea Micciulla, and John Makhoul.</S>
        <S ID="S-30381">2006.</S>
        <S ID="S-30382">A study of translation edit rate with targeted human annotation.</S>
        <S ID="S-30383">In Proc. of AMTA, pages 223&#8211;231, Aug.</S>
      </P>
      <P>
        <S ID="S-30384">Roy Tromble, Shankar Kumar, Franz Och, and Wolfgang Macherey.</S>
        <S ID="S-30385">2008.</S>
        <S ID="S-30386">Lattice Minimum Bayes- Risk decoding for statistical machine translation.</S>
        <S ID="S-30387">In Proceedings of the 2008 Conference on Empirical Methods in Natural Language Processing, pages 620&#8211;629, Honolulu, Hawaii, October.</S>
        <S ID="S-30388">Association for Computational Linguistics.</S>
      </P>
      <P>
        <S ID="S-30389">N. Ueffing, F.J.</S>
        <S ID="S-30390">Och, and H. Ney.</S>
        <S ID="S-30391">2002.</S>
        <S ID="S-30392">Generation of word graphs in statistical machine translation.</S>
        <S ID="S-30393">In Proc. of the Conference on Empirical Methods for Natural Language Processing, pages 156&#8211;163, Philadelphia, PA, USA, July.</S>
      </P>
      <P>
        <S ID="S-30394">Percy Liang, Alexandre Buchard-C&#244;t&#233;, Dan Klein, and Ben Taskar.</S>
        <S ID="S-30395">2006.</S>
        <S ID="S-30396">An End-to-End Discriminative Approach to Machine Translation.</S>
        <S ID="S-30397">In Proceedings of the 21st International Conference on Computational Linguistics and the 44th annual meeting of the Association for Computational Linguistics, pages 761&#8211; 768, Sydney, Australia.</S>
      </P>
      <P>
        <S ID="S-30398">Daniel Marcu and William Wong.</S>
        <S ID="S-30399">2002.</S>
        <S ID="S-30400">A phrasebased, joint probability model for statistical machine translation.</S>
        <S ID="S-30401">In Proceedings of the Conference on Empirical Methods in Natural Language Processing (EMNLP-2002), July.</S>
      </P>
      <P>
        <S ID="S-30402">J.A.</S>
        <S ID="S-30403">Nelder and R. Mead.</S>
        <S ID="S-30404">1965.</S>
        <S ID="S-30405">A Simplex Method for Function Minimization.</S>
        <S ID="S-30406">The Computer Journal), 7:308&#8211;313.</S>
      </P>
      <P>
        <S ID="S-30407">Franz Josef Och and Hermann Ney.</S>
        <S ID="S-30408">2003.</S>
        <S ID="S-30409">A systematic comparison of various statistical alignment models.</S>
        <S ID="S-30410">Computational Linguistics, 29(1):19&#8211;51, March.</S>
      </P>
      <P>
        <S ID="S-30411">Franz Josef Och and Hermann Ney.</S>
        <S ID="S-30412">2004.</S>
        <S ID="S-30413">The alignment template approach to statistical machine translation.</S>
        <S ID="S-30414">Computational Linguistics, 30(4):417&#8211;449, December.</S>
      </P>
    </DIV>
  </BODY>
  <ACKNOWLEDGMENTS/>
  <REFERENCES/>
</PAPER>
